# Mission Deck Backend - Environment Variables
# Copy this file to .env and fill in your actual values

# ============================================================================
# FalkorDB Configuration
# ============================================================================

# FalkorDB REST API endpoint
# Production: https://mindprotocol.onrender.com/admin/query
FALKORDB_API_URL=https://mindprotocol.onrender.com/admin/query

# FalkorDB API authentication key
# Get this from Mind Protocol production environment
FALKORDB_API_KEY=your_falkordb_api_key_here

# Graph name to use (should be 'scopelock' for Mission Deck)
GRAPH_NAME=scopelock

# ============================================================================
# Authentication Configuration
# ============================================================================

# JWT secret key for signing tokens
# Generate a secure random string (32+ characters recommended)
# Example generation: python -c "import secrets; print(secrets.token_urlsafe(32))"
JWT_SECRET=your_jwt_secret_key_here

# ============================================================================
# Claude Integration (for Rafael Chat)
# ============================================================================

# NOTE: Mission Deck uses Claude CLI (subscription) NOT direct API calls.
# This keeps costs on subscription rather than pay-per-token API pricing.
#
# Requirements for deployment:
# 1. Claude CLI must be installed on server: curl -fsSL https://claude.ai/install.sh | bash
# 2. Credentials file must be uploaded: ~/.claude/.credentials.json
# 3. Backend executes: cd citizens/rafael && claude -p "message" --continue --dangerously-skip-permissions
#
# No CLAUDE_API_KEY environment variable needed!

# ============================================================================
# CORS Configuration
# ============================================================================

# Comma-separated list of allowed origins for CORS
# Development: http://localhost:3000,http://localhost:3002
# Production: Add your frontend domain
CORS_ORIGINS=http://localhost:3000,http://localhost:3002

# ============================================================================
# Vercel Auto-Fix Webhook Integration
# ============================================================================

# Endpoint: POST /api/webhooks/vercel-failure
# Purpose: Receives Vercel deployment failure webhooks and auto-invokes Rafael
#
# Configuration required in Vercel project settings:
# 1. Go to: https://vercel.com/mindprotocol/scopelock/settings/webhooks
# 2. Add webhook:
#    - URL: https://scopelock.onrender.com/api/webhooks/vercel-failure
#    - Events: deployment.error (or just "deployment" if error-specific unavailable)
#    - Projects: scopelock
#
# When deployment fails:
# 1. Vercel POSTs to webhook endpoint
# 2. Backend invokes Rafael autonomously via Claude CLI
# 3. Rafael uses Vercel MCP to get build logs
# 4. Rafael diagnoses issue and pushes fix
# 5. Vercel auto-deploys fixed version
#
# Duplicate prevention: Handled deployment IDs tracked in handled-deployments.json
# Status endpoint: GET /api/webhooks/vercel-failure/status
#
# No environment variables needed for webhook functionality.
# Uses existing Claude CLI setup (see Claude Integration section above).

# ============================================================================
# Optional Configuration
# ============================================================================

# Server host (default: 127.0.0.1)
# HOST=0.0.0.0

# Server port (default: 8000)
# PORT=8000

# Log level (default: info)
# LOG_LEVEL=debug
